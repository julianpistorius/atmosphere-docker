---
version: '3'

services:

  atmosphere-alt:
    image: 'alt_atmo'
    volumes:
      - 'alt_env:/opt/env/atmo:rw'
      - 'alt_sockets:/tmp:rw'
      - './logs/celery/atmo:/var/log/celery:rw'
      - './logs/atmosphere:/opt/dev/atmosphere/logs:rw'

  troposphere-alt:
    image: 'alt_tropo'
    volumes:
      - 'alt_env:/opt/env/atmo:rw'
      - 'alt_sockets:/tmp:rw'
      - 'alt_tropo:/opt/dev/troposphere:rw'
      - './logs/celery/tropo:/var/log/celery:rw'
    depends_on:
      - 'atmosphere-alt'

  nginx-alt:
    image: 'alt_nginx'
    volumes:
      - 'alt_sockets:/tmp'
      - 'alt_tropo:/opt/dev/troposphere:rw'
      - './logs/nginx:/var/log/nginx:rw'
    depends_on:
      - 'atmosphere-alt'
      - 'troposphere-alt'
    ports:
      - '443:443'
      - '80:80'

volumes:
  alt_env:
    external: true
  alt_sockets:
    external: true
  alt_tropo:
    external: true
